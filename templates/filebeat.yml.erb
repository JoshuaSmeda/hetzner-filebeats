filebeat:
  prospectors:
<% @prospectors_array.each do | prospector | -%>
    -
      paths:
<% prospector['paths'].each do |path| -%>
        - <%= path %>
<% end -%>
<% if prospector['input_type'] -%>
      input_type: <%= prospector['input_type'] %>
<% end -%>
<% if prospector['doc_type'] != '' -%>
      document_type: <%= prospector['doc_type'] %>
<% end -%>
<% if prospector['include_lines'] -%>
      include_lines: <%= prospector['include_lines'] %>
<% end -%>
<% if prospector['exclude_lines'] -%>
      exclude_lines: <%= prospector['exclude_lines'] %>
<% end -%>
<% if prospector['fields'] -%>
      fields:
  <% prospector['fields'].each do |field| -%>
        <%= field.keys[0] %>: <%= field.values[0] %>
  <% end -%>
<% end -%>
<% end -%>
  registry_file: /var/lib/filebeat/registry
output.logstash:
  hosts: [<%= @logstash_hosts %>]
<% if @loadbalance -%>
  loadbalance: true
<% end -%>
<% if @logstash_index != '' -%>
  index: <%= @logstash_index %>
<% end -%>
<% if @ssl_certificate_authorities != [] -%>
  ssl.certificate_authorities: [<%= @ssl_certificate_authorities %>"
<% end -%>
<% if @ssl_certificate != '' -%>
  ssl.certificate: <%= @ssl_certificate %>
<% end -%>
<% if @ssl_certificate_key != '' -%>
  ssl.certificate_key: <%= @ssl_certificate_key %>
<% end -%>
<% if !@logging.empty? -%>
logging:
  level: <%= @logging['level'] %>
<% if @logging['to_syslog'] %>
  to_syslog: <%= @logging['to_syslog'] %>
<% else -%>
  to_files: <%= @logging['to_files'] %>
  to_syslog: <%= @logging['to_syslog'] %>
  files:
    path: <%= @logging['path'] %>
    name: <%= @logging['name'] %>
    keepfiles: <%= @logging['keepfiles'] %>
<% end -%>
<% end -%>
